<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>News - BRAVEMIND Ukraine</title>
  <meta name="description" content="Latest news and updates from the BRAVEMIND Ukraine project." />
  <style>
    :root{
      --bg:#ffffff; --fg:#0f172a; --muted:#475569; --card:#f8fafc; --border:#e2e8f0; --accent:#1e40af; --accent-contrast:#ffffff;
      --pad: clamp(1rem, 3vw, 2rem);
    }
    @media (prefers-color-scheme: dark){
      :root{ --bg:#0b1020; --fg:#e5e7eb; --muted:#94a3b8; --card:#0f172a; --border:#1f2937; --accent:#3b82f6; --accent-contrast:#0b1020 }
    }
    body.dark{ --bg:#0b1020; --fg:#e5e7eb; --muted:#94a3b8; --card:#0f172a; --border:#1f2937; --accent:#3b82f6; --accent-contrast:#0b1020 }

    *{box-sizing:border-box}
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Helvetica Neue",Arial; background:var(--bg); color:var(--fg); line-height:1.6}
    a{color:var(--accent);text-decoration:none} a:hover{text-decoration:underline}

    .wrap{max-width:1100px;margin:0 auto;padding:var(--pad)}

    header{border-bottom:1px solid var(--border); background:linear-gradient(180deg,rgba(30,64,175,.08),transparent)}
    .topbar{display:flex;align-items:center;justify-content:space-between;gap:1rem}
    .brand{display:flex;align-items:center;gap:.75rem}
    .brand img{width:44px;height:44px;object-fit:contain}
    nav { display: flex; align-items: center; gap: 1rem; }
    nav a { font-weight: 600; color: var(--muted); }
    nav a.active { color: var(--accent); }
    .controls{display:flex;align-items:center; gap:.5rem}
    .btn{border:1px solid var(--border); background:var(--card); color:var(--fg); padding:.55rem .8rem; border-radius:.625rem; cursor:pointer; font-weight:600}

    #mobile-menu-btn { display: none; padding: .55rem; }
    @media (max-width: 800px) { 
        nav { display: none; }
        #mobile-menu-btn { display: inline-flex; align-items: center; justify-content: center; }
    }
    
    .mobile-nav { display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background-color: var(--bg); z-index: 100; flex-direction: column; align-items: center; justify-content: center; gap: 2rem; }
    .mobile-nav.open { display: flex; }
    .mobile-nav a { font-size: 1.5rem; font-weight: 600; color: var(--fg); }
    #close-menu-btn { position: absolute; top: var(--pad); right: var(--pad); font-size: 1.5rem; line-height: 1; padding: .25rem .75rem; }

    .partner-bar-container { border-bottom: 1px solid var(--border); }
    .partner-bar { display: flex; align-items: center; justify-content: center; gap: 1.5rem; padding-top: .75rem; padding-bottom: .75rem; }
    .partner-label { font-size: .9rem; color: var(--muted); font-weight: 500; }
    .header-partner-logos { display: flex; align-items: center; gap: 2rem; filter: grayscale(100%) opacity(0.7); }
    .header-partner-logos img { height: 28px; max-width: 100px; object-fit: contain; }
    @media (max-width: 800px) {
        .partner-bar { flex-direction: column; gap: .75rem; }
        .partner-label { display: none; }
        .header-partner-logos { gap: 1.5rem; justify-content: center; width: 100%; flex-wrap: wrap; }
    }

    main{display:block; min-height: 50vh;}
    h1{font-size:clamp(1.75rem,2.5vw,2.25rem); margin:0 0 .6rem}
    p{margin:.5rem 0 1rem; color:var(--muted)}

    footer{border-top:1px solid var(--border); padding: 2.5rem 0; color:var(--muted)}
    .footer-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; align-items: start; max-width: 1100px; margin: 0 auto; padding: 0 var(--pad); }
    .footer-contact { text-align: right; }
    .footer-contact h3 { margin-top: 0; font-size: 1.1em; color: var(--fg); }
    .footer-contact p { margin: 0.4rem 0; }
    .footer-links a { display: block; margin-top: 0.5rem; color: var(--muted); }
    .footer-links a:hover { color: var(--accent); }
    footer p { margin: 0.25rem 0; }
    @media (max-width: 700px) { .footer-grid { grid-template-columns: 1fr; text-align: center; } .footer-contact { text-align: center; margin-top: 1.5rem; } }
    
    /* Styles for the new blog system */
    .fade-in { animation: fadeIn 0.5s ease-in-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .article-list {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }

    .blog-article {
        background: var(--card);
        border: 1px solid var(--border);
        padding: var(--pad);
        border-radius: .625rem;
        transition: box-shadow 0.3s;
    }
    body:not(.dark) .blog-article:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
    .blog-article h2 { font-size: 1.5rem; margin: 0 0 .5rem; }
    .blog-article .meta { font-size: .9rem; color: var(--muted); margin-bottom: 1rem; }
    .blog-article .summary { color: var(--muted); margin-bottom: 1rem; }
    .blog-article .read-more { font-weight: 600; }
    
    .single-post-view .back-link { display: inline-block; margin-bottom: 1.5rem; font-weight: 600; }
    .single-post-view h1 { margin-bottom: 0.5rem; }
    .single-post-view .meta { color: var(--muted); margin-bottom: 2rem; }
    .single-post-content p { margin-bottom: 1rem; }
    .single-post-content strong { color: var(--fg); }
    .single-post-content ul { list-style-position: inside; padding-left: 1rem; margin-bottom: 1rem; }
    .single-post-content li { margin-bottom: 0.5rem; }
    /* Style for images inside posts */
    .single-post-content img { 
        max-width: 100%; 
        height: auto; 
        border-radius: .625rem; 
        margin: 1.5rem 0;
    }
    /* NEW styles for the image gallery */
    .post-gallery {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
      margin: 1.5rem 0;
    }
    .post-gallery img {
      width: 100%;
      border-radius: .625rem;
      margin: 0;
    }
    @media (max-width: 600px) {
      .post-gallery {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <header></header>

  <main id="content" class="wrap">
    <h1 data-en="News &amp; Updates" data-uk="Новини та оновлення">News &amp; Updates</h1>
    <div id="app-root"></div>
  </main>

  <footer></footer>

  <script src="header.js"></script>
  <script src="posts.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // --- Standard Site Controls (from header.js) ---
      const contrastBtn = document.getElementById('contrast-toggle');
      const isDark = () => document.body.classList.contains('dark');
      const setTheme = mode => {
        if(mode==='dark'){ document.body.classList.add('dark'); } else { document.body.classList.remove('dark'); }
        localStorage.setItem('theme', mode);
        contrastBtn.textContent = isDark() ? 'Light' : 'Dark';
        contrastBtn.setAttribute('aria-pressed', String(isDark()));
      };
      (function initTheme(){
        const stored = localStorage.getItem('theme');
        if (stored) setTheme(stored);
        else if (window.matchMedia?.('(prefers-color-scheme: dark)').matches) setTheme('dark');
        else setTheme('light');
      })();
      contrastBtn.addEventListener('click', () => setTheme(isDark() ? 'light' : 'dark'));

      const langBtn = document.getElementById('lang-toggle');
      const setLang = next => {
        document.documentElement.lang = next;
        document.querySelectorAll('[data-en]').forEach(el => {
          const target_text = next === 'uk' ? el.getAttribute('data-uk') : el.getAttribute('data-en');
          if (target_text != null) { el.innerHTML = target_text; }
        });
        langBtn.textContent = next === 'uk' ? 'UKR / EN' : 'EN / УКР';
        localStorage.setItem('lang', next);
      };
      setLang(localStorage.getItem('lang') || 'en');
      langBtn.addEventListener('click', () => {
        const cur = localStorage.getItem('lang') || 'en';
        setLang(cur.startsWith('en') ? 'uk' : 'en');
      });

      const mobileMenuBtn = document.getElementById('mobile-menu-btn');
      const mobileMenu = document.getElementById('mobile-menu');
      const closeMenuBtn = document.getElementById('close-menu-btn');
      if (mobileMenuBtn && mobileMenu && closeMenuBtn) {
          mobileMenuBtn.addEventListener('click', () => {
              mobileMenu.classList.add('open');
              mobileMenuBtn.setAttribute('aria-expanded', 'true');
          });
          closeMenuBtn.addEventListener('click', () => {
              mobileMenu.classList.remove('open');
              mobileMenuBtn.setAttribute('aria-expanded', 'false');
          });
      }

      // --- BLOG SYSTEM LOGIC ---
      const appRoot = document.getElementById('app-root');

      // If there are no posts in posts.js, display a message.
      if (typeof posts === 'undefined' || posts.length === 0) {
          if(appRoot) {
              appRoot.innerHTML = '<p data-en="Check back soon for the latest news, press releases, and updates from the field." data-uk="Заходьте незабаром, щоб дізнатися останні новини, прес-релізи та оновлення з місця подій.">Check back soon for the latest news, press releases, and updates from the field.</p>';
              // Re-run the language toggle to ensure this new text is translated if needed
              const curLang = localStorage.getItem('lang') || 'en';
              document.querySelectorAll('[data-en]').forEach(el => {
                  const target_text = curLang === 'uk' ? el.getAttribute('data-uk') : el.getAttribute('data-en');
                  if (target_text != null) { el.innerHTML = target_text; }
              });
          }
          return; // Stop here if there are no posts
      }

      function renderPostList() {
          const sortedPosts = posts.sort((a, b) => b.id - a.id);
          let postListHTML = '<div class="article-list fade-in">';
          sortedPosts.forEach(post => {
              postListHTML += `
                  <article class="blog-article">
                      <h2><a href="?post=${post.id}">${post.title}</a></h2>
                      <div class="meta">By ${post.author} on ${post.date}</div>
                      <p class="summary">${post.summary}</p>
                      <a href="?post=${post.id}" class="read-more">Read More &rarr;</a>
                  </article>
              `;
          });
          postListHTML += '</div>';
          appRoot.innerHTML = postListHTML;
      }

      function renderPostView(postId) {
          const post = posts.find(p => p.id === postId);
          if (!post) {
              appRoot.innerHTML = `<div class="fade-in"><p>Post not found.</p><a href="news.html" class="back-link">&larr; Back to all news</a></div>`;
              return;
          }

          const postViewHTML = `
              <div class="single-post-view fade-in">
                  <a href="news.html" class="back-link">&larr; Back to all news</a>
                  <article>
                      <h1>${post.title}</h1>
                      <div class="meta">By ${post.author} on ${post.date}</div>
                      <div class="single-post-content">
                          ${post.content}
                      </div>
                  </article>
              </div>
          `;
          appRoot.innerHTML = postViewHTML;
      }

      function handleRouteChange() {
          const params = new URLSearchParams(window.location.search);
          const postId = params.get('post');
          if (postId) {
              renderPostView(+postId);
          } else {
              renderPostList();
          }
      }
      
      window.addEventListener('popstate', handleRouteChange);
      handleRouteChange(); // Initial render
    });
  </script>
  <script src="footer.js"></script>
</body>
</html>